#!/bin/bash
#Clean up Postgres-XC environment

PSQL_FOLDER=$HOME/pgsql

#cleanup the rest
rm -r $PSQL_FOLDER/datanode1/*
rm -r $PSQL_FOLDER/datanode2/*
rm -r $PSQL_FOLDER/coord1/*
rm -r $PSQL_FOLDER/coord2/*
rm -r $PSQL_FOLDER/proxy1/*
rm -r $PSQL_FOLDER/proxy2/*
rm -r $PSQL_FOLDER/log/*
rm -r $PSQL_FOLDER/gtm/*
rm -r $PSQL_FOLDER/standby/*

#Take out all processes
killall postgres gtm_proxy gtm
sleep 2

#Kill GTM/Standby in the most atrocious way
gtm_pid=`ps ux | grep "gtm -x 100" | grep bin | cut -d " " -f 2-4`
kill -9 $gtm_pid
