#!/bin/bash
#--------------------------------------------------------------------------
# femacs
#	emacs is coupled with find command to launch a file with given name by
#	looking for it from current repository
#	Copyright (c) 2010-2014, Michael Paquier
#--------------------------------------------------------------------------

# Show utility help
show_help()
{
	ERROR_NUM=$1
	echo "Usage: `basename $0` [FILENAME]"
	exit $ERROR_NUM
}

EXPECTED_ARGS=1

# Grab the arguments
FILE_NAME=$1

if [ $# -ne $EXPECTED_ARGS ]
then
	# Leave with an error code
	show_help 1
fi

NUM_FILES=`find . -name "$FILE_NAME" | wc -l | tr -d ' '`
if [ $NUM_FILES == 0 ]
then
	echo "No files $FILE_NAME found in current path"
	exit 1
elif [ $NUM_FILES -gt 1 ]
then
	echo "Multiple finds $FILE_NAME found in current path, files are:"
	find . -name "$FILE_NAME"
	exit 1
fi

# Launch the command as one file has been found
FILE_PATH=`find . -name "$FILE_NAME"`
emacs -nw $FILE_PATH
